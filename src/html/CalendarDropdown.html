<!DOCTYPE html>
<html>

<head>
    <base target="_top">
</head>

<script>
    function onSuccess() {
        google.script.host.close();
    }

    function submit() {
        const choice = document.getElementById('choice').value;

        google.script.run
            .withSuccessHandler(onSuccess)
            .selectCalendarCallback(choice);
    }

    function setup() {
        const button = document.getElementById('submitbutton');
        button.addEventListener("click", submit)
    }
</script>

<body onload="setup()">

<form>
    <? var data = getAllCalendersAsHTMLOption(); ?>
    <select id="choice">
        <? if(Object.prototype.toString.call(data) === '[object Array]') { ?>
        <? for (var i = 0; i < data.length; i++) {?>
        <option value="<?= data[i].value ?>"> <?= data[i].key ?> </option>
        <? } ?>
        <option value="a">b</option>


    </select>
    <button id="submitbutton">Best√§tigen</button>
</form>
</body>

</html>