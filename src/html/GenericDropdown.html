<!DOCTYPE html>
<html>

<head>
    <base target="_top">
    <?!= include('BootstrapImport'); ?>
</head>


<body onload="setup()">

<form>
    <div class="d-flex justify-content-center container-fluid mt-5">
        <div>
            <div class="input-group input-group-lg mb-3">
                <select id="choice" class="form-control-lg">

                    <option value="<?!= data[i].value ?>"> <?!= data[i].key ?> </option>
                </select>

                <div class="input-group-append">
                    <button type="button" class="btn btn-lg btn-outline-success" id="submitbutton">Bestätigen</button>
                </div>
            </div>
        </div>

    </div>
    <div class="alert alert-success" role="alert">
        <h4 class="alert-heading">Aktueller Kalender:</h4>
        <p>Der Aktuelle ausgewählte Kalender ist <strong><?= getCurrentCalendarName(); ?></strong></p>
    </div>
</form>


<?!= include('BootstrapScriptImport'); ?>

<?!= include('JQueryImport'); ?>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>

<script>

    function close() {
        google.script.host.close();
    }

    function submit() {
        const choice = $('#choice').val()

        google.script.run
            .withSuccessHandler(close)
            .selectCalendarCallback(choice);
    }

    function setup() {
        $('#submitbutton').on('click', submit);

        let data = [
            {key: "test",value:"Test-Display"}
        ]

        $.each(data, function (key,value){
            $('#choice')
                .append($("<option></option>")
                    .attr("value", key)
                    .text(value));
        })

        //$("#choice select").val("ValToSelect-TODO").change();


    }

    function buildForm(data){

    }
</script>

</body>

</html>