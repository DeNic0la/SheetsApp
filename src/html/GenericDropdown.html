<!DOCTYPE html>
<html>
<head>
    <base target="_top">
    <?!= include('BootstrapImport'); ?>
</head>

<body onload="setup()">

<form>
    <div class="d-flex justify-content-center container-fluid mt-5">
        <div>
            <div class="input-group input-group-lg mb-3">
                <select id="choice" class="form-select form-select-lg">
                </select>

                <div class="input-group-append">
                    <button type="button" class="btn btn-lg btn-outline-success" id="submitbutton">Best√§tigen</button>
                </div>
            </div>
        </div>
    </div>
    <div class="alert alert-success" role="alert">
        <h4 class="alert-heading"></h4>
        <p></p>
    </div>
</form>


<?!= include('BootstrapScriptImport'); ?>

<?!= include('JQueryImport'); ?>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>

<script>

    function close() {
        google.script.host.close();
    }

    function submit() {
        const choice = $('#choice').val()

        google.script.run
            .withSuccessHandler(close)
            .selectCalendarCallback(choice);
    }

    function setup() {
        $('#submitbutton').on('click', submit);

        let data = [
            {key: "test",value:"Test-Display"},
            {key: "test2",value:"Test-Display2"},
            {key: "test3",value:"Test-Display3"}
        ]
        let context = {
            data: data,
            selected: 'test2'
        }

        buildForm(context)


    }

    function buildForm(context){

        let data = context.data;
        $.each(data, function (key,value){
            $('#choice')
                .append($("<option></option>")
                    .attr("value", key)
                    .text(value))
                    .addClass(
                        (context.selected === key) ?
                            "fw-bold" : ""
                    )
        })

        $("#choice select").val(context.selected).change();
    }


</script>

</body>

</html>